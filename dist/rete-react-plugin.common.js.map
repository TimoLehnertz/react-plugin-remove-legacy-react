{"version":3,"file":"rete-react-plugin.common.js","sources":["src/renderer.ts","src/utils.ts","src/presets/classic/components/ConnectionWrapper.tsx","src/presets/classic/components/Connection.tsx","src/shared/utils.ts","src/shared/drag.tsx","src/presets/classic/components/Control.tsx","src/presets/classic/vars.ts","src/ref-component.tsx","src/presets/classic/components/refs/RefControl.tsx","src/presets/classic/components/refs/RefSocket.tsx","src/presets/classic/components/Node.tsx","src/presets/classic/components/Socket.tsx","src/presets/classic/index.tsx","src/presets/context-menu/hooks.ts","src/presets/context-menu/vars.ts","src/presets/context-menu/styles.ts","src/presets/context-menu/components/Item.tsx","src/presets/context-menu/components/Search.tsx","src/presets/context-menu/components/Menu.tsx","src/presets/context-menu/index.tsx","node_modules/lodash.debounce/index.js","node_modules/usehooks-ts/dist/index.js","src/presets/minimap/utils.ts","src/presets/minimap/components/MiniNode.tsx","src/presets/minimap/components/MiniViewport.tsx","src/presets/minimap/components/Minimap.tsx","src/presets/minimap/index.tsx","src/presets/reroute-pins/Pin.tsx","src/presets/reroute-pins/index.tsx","src/presets/index.ts","src/index.tsx"],"sourcesContent":["import * as React from 'react'\r\nimport * as ReactDOM from 'react-dom'\r\n\r\n// React 18+ root type\r\ninterface Root {\r\n  render(children: React.ReactNode): void\r\n  unmount(): void\r\n}\r\n\r\nexport type HasLegacyRender = (typeof ReactDOM) extends { render(...args: any[]): any } ? true : false\r\n\r\nexport type CreateRoot = (container: Element | DocumentFragment) => Root\r\n\r\ntype ReactDOMRenderer = (\r\n  element: React.ReactElement,\r\n  container: HTMLElement\r\n) => React.Component | Element\r\n\r\nexport type Renderer = { mount: ReactDOMRenderer, unmount: (container: HTMLElement) => void }\r\n\r\nexport function getRenderer(props?: { createRoot?: CreateRoot }): Renderer {\r\n  const createRoot = props?.createRoot\r\n  const wrappers = new WeakMap<HTMLElement, HTMLElement>()\r\n\r\n  function getWrapper(container: HTMLElement) {\r\n    const wrapper = wrappers.get(container)\r\n\r\n    if (wrapper) return wrapper\r\n\r\n    const span = document.createElement('span')\r\n\r\n    container.appendChild(span)\r\n    wrappers.set(container, span)\r\n    return span\r\n  }\r\n\r\n  function removeWrapper(container: HTMLElement): void {\r\n    const wrapper = wrappers.get(container)\r\n\r\n    if (wrapper) {\r\n      wrapper.remove()\r\n      wrappers.delete(container)\r\n    }\r\n  }\r\n\r\n  // React 18+ path with createRoot\r\n  if (createRoot) {\r\n    const roots = new WeakMap<HTMLElement, Root>()\r\n\r\n    return {\r\n      mount: (element: React.ReactElement, container: HTMLElement) => {\r\n        const wrapper = getWrapper(container)\r\n\r\n        let root = roots.get(wrapper)\r\n\r\n        if (!root) {\r\n          root = createRoot(wrapper)\r\n          roots.set(wrapper, root)\r\n        }\r\n\r\n        root.render(element)\r\n        return wrapper.firstElementChild ?? wrapper\r\n      },\r\n      unmount: (container: HTMLElement) => {\r\n        const wrapper = getWrapper(container)\r\n        const root = roots.get(wrapper)\r\n\r\n        if (root) {\r\n          root.unmount()\r\n          roots.delete(wrapper)\r\n        }\r\n        removeWrapper(container)\r\n      }\r\n    }\r\n  }\r\n  throw new Error('Only react 18+ is supported');\r\n}\r\n","import * as React from 'react'\r\nimport { useEffect, useRef, useState } from 'react'\r\nimport { flushSync } from 'react-dom'\r\n\r\nexport function Root({ children, rendered }: { children: React.JSX.Element | null, rendered: () => void }) {\r\n  useEffect(() => {\r\n    rendered()\r\n  })\r\n\r\n  return children\r\n}\r\n\r\nexport function syncFlush() {\r\n  const ready = useRef(false)\r\n\r\n  useEffect(() => {\r\n    ready.current = true\r\n  }, [])\r\n\r\n  return {\r\n    apply(f: () => void) {\r\n      if (ready.current) {\r\n        queueMicrotask(() => {\r\n          flushSync(f)\r\n        })\r\n      } else {\r\n        f()\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\nexport function useRete<T extends { destroy(): void }>(create: (el: HTMLElement) => Promise<T>) {\r\n  const [container, setContainer] = useState<null | HTMLElement>(null)\r\n  const editorRef = useRef<T>(undefined)\r\n  const [editor, setEditor] = useState<T | null>(null)\r\n  // compatible RefObject type for React 18 and earlier\r\n  const ref = useRef<HTMLDivElement>(null) as React.RefObject<HTMLDivElement>\r\n\r\n  useEffect(() => {\r\n    if (container) {\r\n      if (editorRef.current) {\r\n        editorRef.current.destroy()\r\n        container.innerHTML = ''\r\n      }\r\n      void create(container).then(value => {\r\n        editorRef.current = value\r\n        setEditor(value)\r\n      })\r\n    }\r\n  }, [container, create])\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (editorRef.current) {\r\n        editorRef.current.destroy()\r\n      }\r\n    }\r\n  }, [])\r\n  useEffect(() => {\r\n    if (ref.current) {\r\n      setContainer(ref.current)\r\n    }\r\n  }, [ref.current])\r\n\r\n  return [ref, editor] as const\r\n}\r\n","import * as React from 'react'\r\nimport { createContext, useContext, useEffect, useState } from 'react'\r\n\r\nimport { Position } from '../../../types'\r\nimport { syncFlush } from '../../../utils'\r\n\r\nexport type ConnectionContextValue = { start: Position | null, end: Position | null, path: null | string }\r\n\r\nexport const ConnectionContext = createContext<ConnectionContextValue>({\r\n  start: null,\r\n  end: null,\r\n  path: null\r\n})\r\n\r\ntype PositionWatcher = (cb: (value: Position) => void) => (() => void)\r\n\r\ntype Props = {\r\n  children: React.JSX.Element\r\n  start: Position | PositionWatcher\r\n  end: Position | PositionWatcher\r\n  path(start: Position, end: Position): Promise<null | string>\r\n}\r\n\r\nexport function ConnectionWrapper(props: Props) {\r\n  const { children } = props\r\n  const [computedStart, setStart] = useState<Position | null>(null)\r\n  const [computedEnd, setEnd] = useState<Position | null>(null)\r\n  const [path, setPath] = useState<string | null>(null)\r\n  const start = 'x' in props.start\r\n    ? props.start\r\n    : computedStart\r\n  const end = 'x' in props.end\r\n    ? props.end\r\n    : computedEnd\r\n  const flush = syncFlush()\r\n\r\n  useEffect(() => {\r\n    const unwatch1 = typeof props.start === 'function' && props.start(s => {\r\n      flush.apply(() => {\r\n        setStart(s)\r\n      })\r\n    })\r\n    const unwatch2 = typeof props.end === 'function' && props.end(s => {\r\n      flush.apply(() => {\r\n        setEnd(s)\r\n      })\r\n    })\r\n\r\n    return () => {\r\n      if (unwatch1) unwatch1()\r\n      if (unwatch2) unwatch2()\r\n    }\r\n  }, [])\r\n  useEffect(() => {\r\n    if (start && end) void props.path(start, end).then(p => {\r\n      flush.apply(() => {\r\n        setPath(p)\r\n      })\r\n    })\r\n  }, [start, end])\r\n\r\n  return (\r\n    <ConnectionContext.Provider value={{ start, end, path }}>\r\n      {children}\r\n    </ConnectionContext.Provider>\r\n  )\r\n}\r\n\r\nexport function useConnection() {\r\n  return useContext(ConnectionContext)\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { ClassicScheme } from '../types'\r\nimport { useConnection } from './ConnectionWrapper'\r\n\r\nconst Svg = styled.svg`\r\n    overflow: visible !important;\r\n    position: absolute;\r\n    pointer-events: none;\r\n    width: 9999px;\r\n    height: 9999px;\r\n`\r\n\r\nconst Path = styled.path<{ styles?: (props: any) => any }>`\r\n    fill: none;\r\n    stroke-width: 5px;\r\n    stroke: steelblue;\r\n    pointer-events: auto;\r\n    ${props => props.styles?.(props)}\r\n`\r\n\r\nexport function Connection(props: { data: ClassicScheme['Connection'] & { isLoop?: boolean }, styles?: () => any }) {\r\n  const { path } = useConnection()\r\n\r\n  if (!path) return null\r\n\r\n  return (\r\n    <Svg data-testid=\"connection\">\r\n      <Path\r\n        styles={props.styles}\r\n        d={path} />\r\n    </Svg>\r\n  )\r\n}\r\n","export function copyEvent<T extends Event & Record<string, any>>(e: T) {\r\n  const newEvent = new (e.constructor as new(type: string) => T)(e.type)\r\n  let current = newEvent\r\n\r\n  // eslint-disable-next-line no-cond-assign\r\n  while (current = Object.getPrototypeOf(current)) {\r\n    const keys = Object.getOwnPropertyNames(current)\r\n\r\n    for (const k of keys) {\r\n      const item = newEvent[k]\r\n\r\n      if (typeof item === 'function') continue\r\n\r\n      Object.defineProperty(newEvent, k, { value: e[k] })\r\n    }\r\n  }\r\n\r\n  return newEvent\r\n}\r\n\r\nconst rootPrefix = '__reactContainer$'\r\n\r\ntype Keys = `${typeof rootPrefix}${string}` | '_reactRootContainer'\r\ntype ReactNode = Partial<Record<Keys, unknown>> & HTMLElement\r\n\r\nexport function findReactRoot(element: HTMLElement) {\r\n  let current: ReactNode | null = element as ReactNode\r\n\r\n  while (current) {\r\n    if (current._reactRootContainer || Object.keys(current).some(key => key.startsWith(rootPrefix))) return current\r\n    current = current.parentElement as ReactNode\r\n  }\r\n}\r\n","import * as React from 'react'\r\n\r\nimport { Position } from '../types'\r\nimport { copyEvent, findReactRoot } from './utils'\r\n\r\ntype Translate = (dx: number, dy: number) => void\r\ntype StartEvent = { pageX: number, pageY: number }\r\n\r\nexport function useDrag(translate: Translate, getPointer: (e: StartEvent) => Position) {\r\n  return {\r\n    start(e: StartEvent) {\r\n      let previous = { ...getPointer(e) }\r\n\r\n      function move(moveEvent: MouseEvent) {\r\n        const current = { ...getPointer(moveEvent) }\r\n        const dx = current.x - previous.x\r\n        const dy = current.y - previous.y\r\n\r\n        previous = current\r\n\r\n        translate(dx, dy)\r\n      }\r\n      function up() {\r\n        window.removeEventListener('pointermove', move)\r\n        window.removeEventListener('pointerup', up)\r\n        window.removeEventListener('pointercancel', up)\r\n      }\r\n\r\n      window.addEventListener('pointermove', move)\r\n      window.addEventListener('pointerup', up)\r\n      window.addEventListener('pointercancel', up)\r\n    }\r\n  }\r\n}\r\n\r\nexport function useNoDrag(ref: React.MutableRefObject<HTMLElement | null>, disabled?: boolean) {\r\n  React.useEffect(() => {\r\n    const handleClick = (e: PointerEvent) => {\r\n      if (disabled) return\r\n\r\n      const root = findReactRoot(e.target as HTMLElement)\r\n      const target = React.version.startsWith('16')\r\n        ? document\r\n        : root\r\n\r\n      if (target) {\r\n        e.stopPropagation()\r\n        target.dispatchEvent(copyEvent(e))\r\n      }\r\n    }\r\n    const el = ref.current\r\n\r\n    el?.addEventListener('pointerdown', handleClick)\r\n\r\n    return () => {\r\n      el?.removeEventListener('pointerdown', handleClick)\r\n    }\r\n  }, [ref, disabled])\r\n}\r\n\r\nexport function NoDrag(props: { children: React.ReactNode, disabled?: boolean }) {\r\n  const ref = React.useRef<HTMLDivElement | null>(null)\r\n\r\n  useNoDrag(ref, props.disabled)\r\n\r\n  return <span ref={ref}>{props.children}</span>\r\n}\r\n","import * as React from 'react'\r\nimport { ClassicPreset } from 'rete'\r\nimport styled from 'styled-components'\r\n\r\nimport { Drag } from '../../../shared'\r\n\r\nconst Input = styled.input<{ styles?: (props: any) => any }>`\r\n  width: 100%;\r\n  border-radius: 30px;\r\n  background-color: white;\r\n  padding: 2px 6px;\r\n  border: 1px solid #999;\r\n  font-size: 110%;\r\n  box-sizing: border-box;\r\n  ${props => props.styles?.(props)}\r\n`\r\n\r\nexport function Control<N extends 'text' | 'number'>(props: { data: ClassicPreset.InputControl<N>, styles?: () => any }) {\r\n  const [value, setValue] = React.useState(props.data.value)\r\n  const ref = React.useRef(null)\r\n\r\n  Drag.useNoDrag(ref)\r\n\r\n  React.useEffect(() => {\r\n    setValue(props.data.value)\r\n  }, [props.data.value])\r\n\r\n  return (\r\n    <Input\r\n      value={value}\r\n      type={props.data.type}\r\n      ref={ref}\r\n      readOnly={props.data.readonly}\r\n      onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\r\n        const val = (props.data.type === 'number'\r\n          ? +e.target.value\r\n          : e.target.value) as typeof props.data['value']\r\n\r\n        setValue(val)\r\n        props.data.setValue(val)\r\n      }}\r\n      styles={props.styles}\r\n    />\r\n  )\r\n}\r\n","export const $nodecolor = 'rgba(110,136,255,0.8)'\r\nexport const $nodecolorselected = '#ffd92c'\r\nexport const $socketsize = 24\r\nexport const $socketmargin = 6\r\nexport const $socketcolor = '#96b38a'\r\nexport const $nodewidth = 180\r\n","import * as React from 'react'\r\n\r\ntype RefUpdate = (ref: HTMLElement) => void\r\ntype BaseProps = { init: RefUpdate, unmount: RefUpdate } & Record<string, unknown>\r\n\r\n/**\r\n * Component for rendering various elements embedded in the React.js component tree.\r\n */\r\nexport function RefComponent<Props extends BaseProps>({ init, unmount, ...props }: Props) {\r\n  const ref = React.useRef<HTMLSpanElement>(null)\r\n\r\n  React.useEffect(() => {\r\n    const element = ref.current\r\n\r\n    return () => {\r\n      if (element) unmount(element)\r\n    }\r\n  }, [])\r\n  React.useEffect(() => {\r\n    if (ref.current) init(ref.current)\r\n  })\r\n\r\n  return <span {...props} ref={ref} />\r\n}\r\n","import * as React from 'react'\r\nimport { ClassicPreset } from 'rete'\r\n\r\nimport { RefComponent } from '../../../../ref-component'\r\nimport { ClassicScheme, GetControls, ReactArea2D } from '../../types'\r\n\r\ntype Props<Scheme extends ClassicScheme> = {\r\n  name: string\r\n  emit: (props: ReactArea2D<Scheme>) => void\r\n  payload: ClassicPreset.Control\r\n}\r\n\r\nexport function RefControl<Scheme extends ClassicScheme>({ name, emit, payload, ...props }: Props<Scheme>) {\r\n  return <RefComponent\r\n    {...props}\r\n    className={name}\r\n    init={ref => {\r\n      emit({ type: 'render',\r\n        data: {\r\n          type: 'control',\r\n          element: ref,\r\n          payload: payload as GetControls<Scheme['Node']>\r\n        } })\r\n    }}\r\n    unmount={ref => {\r\n      emit({ type: 'unmount', data: { element: ref } })\r\n    }}\r\n  />\r\n}\r\n","import * as React from 'react'\r\nimport { ClassicPreset, NodeId } from 'rete'\r\n\r\nimport { RefComponent } from '../../../../ref-component'\r\nimport { ClassicScheme, GetSockets, ReactArea2D, Side } from '../../types'\r\n\r\ntype Props<Scheme extends ClassicScheme> = {\r\n  name: string\r\n  emit: (props: ReactArea2D<Scheme>) => void\r\n  side: Side\r\n  nodeId: NodeId\r\n  socketKey: string\r\n  payload: ClassicPreset.Socket\r\n}\r\n\r\nexport function RefSocket<Scheme extends ClassicScheme>({ name, emit, nodeId, side, socketKey, payload, ...props }: Props<Scheme>) {\r\n  return <RefComponent\r\n    {...props}\r\n    className={name}\r\n    init={ref => {\r\n      emit({ type: 'render',\r\n        data: {\r\n          type: 'socket',\r\n          side,\r\n          key: socketKey,\r\n          nodeId,\r\n          element: ref,\r\n          payload: payload as GetSockets<Scheme['Node']>\r\n        } })\r\n    }}\r\n    unmount={ref => {\r\n      emit({ type: 'unmount', data: { element: ref } })\r\n    }}\r\n  />\r\n}\r\n","import * as React from 'react'\r\nimport styled, { css } from 'styled-components'\r\n\r\nimport { ClassicScheme, RenderEmit } from '../types'\r\nimport { $nodecolor, $nodecolorselected, $nodewidth, $socketmargin, $socketsize } from '../vars'\r\nimport { RefControl } from './refs/RefControl'\r\nimport { RefSocket } from './refs/RefSocket'\r\n\r\ntype NodeExtraData = { width?: number, height?: number }\r\n\r\nexport const NodeStyles = styled.div<NodeExtraData & { selected: boolean, styles?: (props: any) => any }>`\r\n    background: ${$nodecolor};\r\n    border: 2px solid #4e58bf;\r\n    border-radius: 10px;\r\n    cursor: pointer;\r\n    box-sizing: border-box;\r\n    width: ${props => Number.isFinite(props.width)\r\n      ? `${props.width}px`\r\n      : `${$nodewidth}px`};\r\n    height: ${props => Number.isFinite(props.height)\r\n      ? `${props.height}px`\r\n      : 'auto'};\r\n    padding-bottom: 6px;\r\n    position: relative;\r\n    user-select: none;\r\n    line-height: initial;\r\n    font-family: Arial;\r\n\r\n    &:hover {\r\n        background: lighten(${$nodecolor},4%);\r\n    }\r\n    ${props => props.selected && css`\r\n        background: ${$nodecolorselected};\r\n        border-color: #e3c000;\r\n    `}\r\n    .title {\r\n        color: white;\r\n        font-family: sans-serif;\r\n        font-size: 18px;\r\n        padding: 8px;\r\n    }\r\n    .output {\r\n        text-align: right;\r\n    }\r\n    .input {\r\n        text-align: left;\r\n    }\r\n    .output-socket {\r\n        text-align: right;\r\n        margin-right: -${$socketsize / 2 + $socketmargin}px;\r\n        display: inline-block;\r\n    }\r\n    .input-socket {\r\n        text-align: left;\r\n        margin-left: -${$socketsize / 2 + $socketmargin}px;\r\n        display: inline-block;\r\n    }\r\n    .input-title,.output-title {\r\n        vertical-align: middle;\r\n        color: white;\r\n        display: inline-block;\r\n        font-family: sans-serif;\r\n        font-size: 14px;\r\n        margin: ${$socketmargin}px;\r\n        line-height: ${$socketsize}px;\r\n    }\r\n    .input-control {\r\n        z-index: 1;\r\n        width: calc(100% - ${$socketsize + 2 * $socketmargin}px);\r\n        vertical-align: middle;\r\n        display: inline-block;\r\n    }\r\n    .control {\r\n        display: block;\r\n        padding: ${$socketmargin}px ${$socketsize / 2 + $socketmargin}px;\r\n    }\r\n    ${props => props.styles?.(props)}\r\n`\r\n\r\nfunction sortByIndex<T extends [string, undefined | { index?: number }][]>(entries: T) {\r\n  entries.sort((a, b) => {\r\n    const ai = a[1]?.index || 0\r\n    const bi = b[1]?.index || 0\r\n\r\n    return ai - bi\r\n  })\r\n}\r\n\r\ntype Props<S extends ClassicScheme> = {\r\n  data: S['Node'] & NodeExtraData\r\n  styles?: () => any\r\n  emit: RenderEmit<S>\r\n}\r\nexport type NodeComponent<Scheme extends ClassicScheme> = (props: Props<Scheme>) => JSX.Element\r\n\r\nexport function Node<Scheme extends ClassicScheme>(props: Props<Scheme>) {\r\n  const inputs = Object.entries(props.data.inputs)\r\n  const outputs = Object.entries(props.data.outputs)\r\n  const controls = Object.entries(props.data.controls)\r\n  const selected = props.data.selected || false\r\n  const { id, label, width, height } = props.data\r\n\r\n  sortByIndex(inputs)\r\n  sortByIndex(outputs)\r\n  sortByIndex(controls)\r\n\r\n  return (\r\n    <NodeStyles\r\n      selected={selected}\r\n      width={width}\r\n      height={height}\r\n      styles={props.styles}\r\n      data-testid=\"node\"\r\n    >\r\n      <div className=\"title\" data-testid=\"title\">{label}</div>\r\n      {/* Outputs */}\r\n      {outputs.map(([key, output]) => output && <div className=\"output\" key={key} data-testid={`output-${key}`}>\r\n        <div className=\"output-title\" data-testid=\"output-title\">{output.label}</div>\r\n        <RefSocket\r\n          name=\"output-socket\"\r\n          side=\"output\"\r\n          socketKey={key}\r\n          nodeId={id}\r\n          emit={props.emit}\r\n          payload={output.socket}\r\n          data-testid=\"output-socket\"\r\n        />\r\n      </div>)}\r\n      {/* Controls */}\r\n      {controls.map(([key, control]) => {\r\n        return control\r\n          ? <RefControl\r\n            key={key}\r\n            name=\"control\"\r\n            emit={props.emit}\r\n            payload={control}\r\n            data-testid={`control-${key}`}\r\n          />\r\n          : null\r\n      })}\r\n      {/* Inputs */}\r\n      {inputs.map(([key, input]) => input && <div className=\"input\" key={key} data-testid={`input-${key}`}>\r\n        <RefSocket\r\n          name=\"input-socket\"\r\n          side=\"input\"\r\n          socketKey={key}\r\n          nodeId={id}\r\n          emit={props.emit}\r\n          payload={input.socket}\r\n          data-testid=\"input-socket\"\r\n        />\r\n        {input && (!input.control || !input.showControl)\r\n        && <div className=\"input-title\" data-testid=\"input-title\">{input.label}</div>\r\n        }\r\n        {input.control && input.showControl && (\r\n          <RefControl\r\n            key={key}\r\n            name=\"input-control\"\r\n            emit={props.emit}\r\n            payload={input.control}\r\n            data-testid=\"input-control\"\r\n          />\r\n        )\r\n        }\r\n      </div>)}\r\n    </NodeStyles>\r\n  )\r\n}\r\n","import * as React from 'react'\r\nimport { ClassicPreset } from 'rete'\r\nimport styled from 'styled-components'\r\n\r\nimport { $socketcolor, $socketmargin, $socketsize } from '../vars'\r\n\r\nconst Styles = styled.div`\r\n    display: inline-block;\r\n    cursor: pointer;\r\n    border: 1px solid white;\r\n    border-radius: ${$socketsize / 2.0}px;\r\n    width: ${$socketsize}px;\r\n    height: ${$socketsize}px;\r\n    vertical-align: middle;\r\n    background: ${$socketcolor};\r\n    z-index: 2;\r\n    box-sizing: border-box;\r\n    &:hover {\r\n      border-width: 4px;\r\n    }\r\n    &.multiple {\r\n      border-color: yellow;\r\n    }\r\n`\r\n\r\nconst Hoverable = styled.div`\r\n    border-radius: ${($socketsize + $socketmargin * 2) / 2.0}px;\r\n    padding: ${$socketmargin}px;\r\n    &:hover ${Styles} {\r\n      border-width: 4px;\r\n    }\r\n`\r\n\r\nexport function Socket<T extends ClassicPreset.Socket>(props: { data: T }) {\r\n  return (\r\n    <Hoverable>\r\n      <Styles title={props.data.name} />\r\n    </Hoverable>\r\n  )\r\n}\r\n","import * as React from 'react'\r\nimport { ClassicPreset, Scope } from 'rete'\r\nimport {\r\n  classicConnectionPath, getDOMSocketPosition,\r\n  loopConnectionPath, SocketPositionWatcher\r\n} from 'rete-render-utils'\r\n\r\nimport { Position } from '../../types'\r\nimport { RenderPreset } from '../types'\r\nimport { Connection } from './components/Connection'\r\nimport { ConnectionWrapper } from './components/ConnectionWrapper'\r\nimport { Control } from './components/Control'\r\nimport { Node } from './components/Node'\r\nimport { Socket } from './components/Socket'\r\nimport {\r\n  ClassicScheme, ExtractPayload, ReactArea2D, RenderEmit\r\n} from './types'\r\nimport { AcceptComponent } from './utility-types'\r\n\r\nexport { Connection } from './components/Connection'\r\nexport { useConnection } from './components/ConnectionWrapper'\r\nexport { Control } from './components/Control'\r\nexport { Control as InputControl } from './components/Control'\r\nexport { Node, NodeStyles } from './components/Node'\r\nexport { RefControl } from './components/refs/RefControl'\r\nexport { RefSocket } from './components/refs/RefSocket'\r\nexport { Socket } from './components/Socket'\r\nexport type { ClassicScheme, ReactArea2D, RenderEmit } from './types'\r\nexport * as vars from './vars'\r\n\r\ntype CustomizationProps<Schemes extends ClassicScheme> = {\r\n  node?: (data: ExtractPayload<Schemes, 'node'>) => AcceptComponent<typeof data['payload'], { emit: RenderEmit<Schemes> }> | null\r\n  connection?: (data: ExtractPayload<Schemes, 'connection'>) => AcceptComponent<typeof data['payload']> | null\r\n  socket?: (data: ExtractPayload<Schemes, 'socket'>) => AcceptComponent<typeof data['payload']> | null\r\n  control?: (data: ExtractPayload<Schemes, 'control'>) => AcceptComponent<typeof data['payload']> | null\r\n}\r\n\r\ntype ClassicProps<Schemes extends ClassicScheme, K> = {\r\n  socketPositionWatcher?: SocketPositionWatcher<Scope<never, [K]>>\r\n  customize?: CustomizationProps<Schemes>\r\n}\r\n\r\n/**\r\n * Classic preset for rendering nodes, connections, controls and sockets.\r\n */\r\nexport function setup<\r\n  Schemes extends ClassicScheme, K extends ReactArea2D<Schemes>\r\n>(props?: ClassicProps<Schemes, K>): RenderPreset<Schemes, K> {\r\n  const positionWatcher = typeof props?.socketPositionWatcher === 'undefined'\r\n    ? getDOMSocketPosition<Schemes, K>()\r\n    : props.socketPositionWatcher\r\n  const { node, connection, socket, control } = props?.customize || {}\r\n\r\n  return {\r\n    attach(plugin) {\r\n      positionWatcher.attach(plugin as unknown as Scope<never, [K]>)\r\n    },\r\n    // eslint-disable-next-line complexity\r\n    render(context, plugin) {\r\n      if (context.data.type === 'node') {\r\n        const parent = plugin.parentScope()\r\n        const Component = (node\r\n          ? node(context.data)\r\n          : Node) as typeof Node\r\n\r\n        return Component\r\n          && <Component\r\n            data={context.data.payload}\r\n            emit={data => void parent.emit(data as any)}\r\n          />\r\n      } else if (context.data.type === 'connection') {\r\n        const Component = (connection\r\n          ? connection(context.data)\r\n          : Connection) as typeof Connection\r\n        const payload = context.data.payload\r\n        const { sourceOutput, targetInput, source, target } = payload\r\n\r\n        return Component\r\n          && <ConnectionWrapper\r\n            start={context.data.start || (change => positionWatcher.listen(source, 'output', sourceOutput, change))}\r\n            end={context.data.end || (change => positionWatcher.listen(target, 'input', targetInput, change))}\r\n            path={async (start, end) => {\r\n              type FixImplicitAny = typeof plugin.__scope.produces | undefined\r\n              const response: FixImplicitAny = await plugin.emit({\r\n                type: 'connectionpath',\r\n                data: {\r\n                  payload,\r\n                  points: [start, end]\r\n                }\r\n              })\r\n\r\n              if (!response) return ''\r\n\r\n              const { path, points } = response.data\r\n              const curvature = 0.3\r\n\r\n              if (!path && points.length !== 2) throw new Error('cannot render connection with a custom number of points')\r\n              if (!path) return payload.isLoop\r\n                ? loopConnectionPath(points as [Position, Position], curvature, 120)\r\n                : classicConnectionPath(points as [Position, Position], curvature)\r\n\r\n              return path\r\n            }}\r\n          >\r\n            <Component data={context.data.payload} />\r\n          </ConnectionWrapper>\r\n      } else if (context.data.type === 'socket') {\r\n        const Component = (socket\r\n          ? socket(context.data)\r\n          : Socket) as typeof Socket\r\n\r\n        return Component && context.data.payload && <Component data={context.data.payload} />\r\n      } else if (context.data.type === 'control') {\r\n        const Component = control && context.data.payload\r\n          ? control(context.data)\r\n          : context.data.payload instanceof ClassicPreset.InputControl\r\n            ? Control\r\n            : null\r\n\r\n        return Component && <Component data={context.data.payload as any} />\r\n      }\r\n    }\r\n  }\r\n}\r\n","import { useEffect, useRef } from 'react'\r\n\r\nexport function useDebounce(cb: () => void, timeout: number): [null | (() => void), () => void] {\r\n  const ref = useRef<ReturnType<typeof setTimeout>>(undefined)\r\n\r\n  function cancel() {\r\n    if (ref.current) {\r\n      clearTimeout(ref.current)\r\n    }\r\n  }\r\n  const func = () => {\r\n    cancel()\r\n\r\n    ref.current = setTimeout(() => {\r\n      cb()\r\n    }, timeout)\r\n  }\r\n\r\n  useEffect(() => cancel, [])\r\n\r\n  return [\r\n    func,\r\n    cancel\r\n  ]\r\n}\r\n","\r\nexport const $contextColor = 'rgba(110,136,255,0.8)'\r\nexport const $contextColorLight = 'rgba(130, 153, 255, 0.8)'\r\nexport const $contextColorDark = 'rgba(69, 103, 255, 0.8)'\r\nexport const $contextMenuRound = '5px'\r\nexport const $width = 120\r\n","import styled from 'styled-components'\r\n\r\nimport { $contextColor, $contextColorDark, $contextColorLight, $contextMenuRound } from './vars'\r\n\r\nexport const CommonStyle = styled.div`\r\n  color: #fff;\r\n  padding: 4px;\r\n  border-bottom: 1px solid ${$contextColorDark};\r\n  background-color: ${$contextColor};\r\n  cursor: pointer;\r\n  width: 100%;\r\n  position: relative;\r\n  &:first-child {\r\n    border-top-left-radius: ${$contextMenuRound};\r\n    border-top-right-radius: ${$contextMenuRound};\r\n  }\r\n  &:last-child {\r\n    border-bottom-left-radius: ${$contextMenuRound};\r\n    border-bottom-right-radius: ${$contextMenuRound};\r\n  }\r\n  &:hover {\r\n    background-color: ${$contextColorLight};\r\n  }\r\n`\r\n","import * as React from 'react'\r\nimport styled, { css } from 'styled-components'\r\n\r\nimport { useDebounce } from '../hooks'\r\nimport { CommonStyle } from '../styles'\r\nimport { Customize, Item } from '../types'\r\nimport { $width } from '../vars'\r\n\r\nexport const ItemStyle = styled(CommonStyle) <{ hasSubitems?: boolean }>`\r\n    ${props => props.hasSubitems && css`&:after {\r\n    content: 'â–º';\r\n    position: absolute;\r\n    opacity: 0.6;\r\n    right: 5px;\r\n    top: 5px;\r\n    }`}\r\n`\r\n\r\nexport const SubitemStyles = styled.div`\r\n    position: absolute;\r\n    top: 0;\r\n    left: 100%;\r\n    width: ${$width}px;\r\n`\r\n\r\ntype Props = {\r\n  data: Item\r\n  delay: number\r\n  hide(): void\r\n  children: React.ReactNode\r\n  components?: Pick<Customize, 'item' | 'subitems'>\r\n}\r\n\r\nexport function ItemElement(props: Props) {\r\n  const [visibleSubitems, setVisibleSubitems] = React.useState(false)\r\n  const setInvisibile = React.useCallback(() => {\r\n    setVisibleSubitems(false)\r\n  }, [setVisibleSubitems])\r\n  const [hide, cancelHide] = useDebounce(setInvisibile, props.delay)\r\n  const Component = props.components?.item?.(props.data) || ItemStyle\r\n  const Subitems = props.components?.subitems?.(props.data) || SubitemStyles\r\n\r\n  return <Component\r\n    onClick={(e: React.MouseEvent) => {\r\n      e.stopPropagation()\r\n      props.data.handler()\r\n      props.hide()\r\n    }}\r\n    hasSubitems={Boolean(props.data.subitems)}\r\n    onPointerDown={(e: React.PointerEvent) => {\r\n      e.stopPropagation()\r\n    }}\r\n    onPointerOver={() => {\r\n      cancelHide()\r\n      setVisibleSubitems(true)\r\n    }}\r\n    onPointerLeave={() => {\r\n      if (hide) hide()\r\n    }}\r\n    data-testid=\"context-menu-item\"\r\n  >\r\n    {props.children}\r\n    {props.data.subitems && visibleSubitems && (\r\n      <Subitems>\r\n        {props.data.subitems.map(item => (\r\n          <ItemElement\r\n            key={item.key}\r\n            data={item}\r\n            delay={props.delay}\r\n            hide={props.hide}\r\n            components={props.components}\r\n          >{item.label}</ItemElement>\r\n        ))}\r\n      </Subitems>\r\n    )}\r\n  </Component>\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { ComponentType } from '../types'\r\n\r\nexport const SearchInput = styled.input`\r\n  color: white;\r\n  padding: 1px 8px;\r\n  border: 1px solid white;\r\n  border-radius: 10px;\r\n  font-size: 16px;\r\n  font-family: serif;\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  background: transparent;\r\n`\r\n\r\nexport function Search(props: { value: string, onChange(value: string): void, component?: ComponentType }) {\r\n  const Component = props.component || SearchInput\r\n\r\n  return (\r\n    <Component\r\n      value={props.value}\r\n      onInput={(e: React.FormEvent<HTMLInputElement>) => {\r\n        props.onChange((e.target as HTMLInputElement).value)\r\n      }}\r\n      onPointerDown={(e: React.PointerEvent) => {\r\n        e.stopPropagation()\r\n      }}\r\n      data-testid=\"context-menu-search-input\"\r\n    />\r\n  )\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { useDebounce } from '../hooks'\r\nimport { CommonStyle } from '../styles'\r\nimport { Customize, Item } from '../types'\r\nimport { $width } from '../vars'\r\nimport { ItemElement } from './Item'\r\nimport { Search } from './Search'\r\n\r\nexport const Styles = styled.div`\r\n  padding: 10px;\r\n  width: ${$width}px;\r\n  margin-top: -20px;\r\n  margin-left: -${$width / 2}px;\r\n`\r\n\r\ntype Props = {\r\n  items: Item[]\r\n  delay: number\r\n  searchBar?: boolean\r\n  onHide(): void\r\n  components?: Customize\r\n}\r\n\r\nexport function Menu(props: Props) {\r\n  const [hide, cancelHide] = useDebounce(props.onHide, props.delay)\r\n  const [filter, setFilter] = React.useState('')\r\n  const filterRegexp = new RegExp(filter, 'i')\r\n  const filteredList = props.items.filter(item => item.label.match(filterRegexp))\r\n  const Component = props.components?.main?.() || Styles\r\n  const Common = props.components?.common?.() || CommonStyle\r\n\r\n  return <Component\r\n    onMouseOver={() => {\r\n      cancelHide()\r\n    }}\r\n    onMouseLeave={() => {\r\n      hide?.()\r\n    }}\r\n    onWheel={(e: React.WheelEvent) => {\r\n      e.stopPropagation()\r\n    }}\r\n    data-testid=\"context-menu\"\r\n  >\r\n    {props.searchBar && (\r\n      <Common>\r\n        <Search value={filter} onChange={setFilter} component={props.components?.search?.()} />\r\n      </Common>\r\n    )}\r\n    {filteredList.map(item => {\r\n      return <ItemElement\r\n        key={item.key}\r\n        data={item}\r\n        delay={props.delay}\r\n        hide={props.onHide}\r\n        components={props.components}\r\n      >\r\n        {item.label}\r\n      </ItemElement>\r\n    })}\r\n  </Component>\r\n}\r\n","import * as React from 'react'\r\nimport { BaseSchemes } from 'rete'\r\n\r\nimport { RenderPreset } from '../types'\r\nimport { Menu } from './components/Menu'\r\nimport { ContextMenuRender, Customize } from './types'\r\n\r\nexport { ItemStyle as Item, SubitemStyles as Subitems } from './components/Item'\r\nexport { Styles as Menu } from './components/Menu'\r\nexport { SearchInput as Search } from './components/Search'\r\nexport { CommonStyle as Common } from './styles'\r\n\r\ntype Props = {\r\n  delay?: number\r\n  customize?: Customize\r\n}\r\n\r\n/**\r\n * Preset for rendering context menu.\r\n */\r\nexport function setup<Schemes extends BaseSchemes, K extends ContextMenuRender>(props?: Props): RenderPreset<Schemes, K> {\r\n  const delay = typeof props?.delay === 'undefined'\r\n    ? 1000\r\n    : props.delay\r\n\r\n  return {\r\n    render(context) {\r\n      if (context.data.type === 'contextmenu') {\r\n        return <Menu\r\n          items={context.data.items}\r\n          delay={delay}\r\n          searchBar={context.data.searchBar}\r\n          onHide={context.data.onHide}\r\n          components={props?.customize}\r\n        />\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","import { useState, useCallback, useLayoutEffect, useEffect, useRef, useMemo } from 'react';\nimport debounce from 'lodash.debounce';\n\n// src/useBoolean/useBoolean.ts\nfunction useBoolean(defaultValue = false) {\n  if (typeof defaultValue !== \"boolean\") {\n    throw new Error(\"defaultValue must be `true` or `false`\");\n  }\n  const [value, setValue] = useState(defaultValue);\n  const setTrue = useCallback(() => {\n    setValue(true);\n  }, []);\n  const setFalse = useCallback(() => {\n    setValue(false);\n  }, []);\n  const toggle = useCallback(() => {\n    setValue((x) => !x);\n  }, []);\n  return { value, setValue, setTrue, setFalse, toggle };\n}\nvar useIsomorphicLayoutEffect = typeof window !== \"undefined\" ? useLayoutEffect : useEffect;\n\n// src/useEventListener/useEventListener.ts\nfunction useEventListener(eventName, handler, element, options) {\n  const savedHandler = useRef(handler);\n  useIsomorphicLayoutEffect(() => {\n    savedHandler.current = handler;\n  }, [handler]);\n  useEffect(() => {\n    const targetElement = (element == null ? void 0 : element.current) ?? window;\n    if (!(targetElement && targetElement.addEventListener))\n      return;\n    const listener = (event) => {\n      savedHandler.current(event);\n    };\n    targetElement.addEventListener(eventName, listener, options);\n    return () => {\n      targetElement.removeEventListener(eventName, listener, options);\n    };\n  }, [eventName, element, options]);\n}\n\n// src/useClickAnyWhere/useClickAnyWhere.ts\nfunction useClickAnyWhere(handler) {\n  useEventListener(\"click\", (event) => {\n    handler(event);\n  });\n}\nfunction useCopyToClipboard() {\n  const [copiedText, setCopiedText] = useState(null);\n  const copy = useCallback(async (text) => {\n    if (!(navigator == null ? void 0 : navigator.clipboard)) {\n      console.warn(\"Clipboard not supported\");\n      return false;\n    }\n    try {\n      await navigator.clipboard.writeText(text);\n      setCopiedText(text);\n      return true;\n    } catch (error) {\n      console.warn(\"Copy failed\", error);\n      setCopiedText(null);\n      return false;\n    }\n  }, []);\n  return [copiedText, copy];\n}\nfunction useCounter(initialValue) {\n  const [count, setCount] = useState(initialValue ?? 0);\n  const increment = useCallback(() => {\n    setCount((x) => x + 1);\n  }, []);\n  const decrement = useCallback(() => {\n    setCount((x) => x - 1);\n  }, []);\n  const reset = useCallback(() => {\n    setCount(initialValue ?? 0);\n  }, [initialValue]);\n  return {\n    count,\n    increment,\n    decrement,\n    reset,\n    setCount\n  };\n}\nfunction useInterval(callback, delay) {\n  const savedCallback = useRef(callback);\n  useIsomorphicLayoutEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n  useEffect(() => {\n    if (delay === null) {\n      return;\n    }\n    const id = setInterval(() => {\n      savedCallback.current();\n    }, delay);\n    return () => {\n      clearInterval(id);\n    };\n  }, [delay]);\n}\n\n// src/useCountdown/useCountdown.ts\nfunction useCountdown({\n  countStart,\n  countStop = 0,\n  intervalMs = 1e3,\n  isIncrement = false\n}) {\n  const {\n    count,\n    increment,\n    decrement,\n    reset: resetCounter\n  } = useCounter(countStart);\n  const {\n    value: isCountdownRunning,\n    setTrue: startCountdown,\n    setFalse: stopCountdown\n  } = useBoolean(false);\n  const resetCountdown = useCallback(() => {\n    stopCountdown();\n    resetCounter();\n  }, [stopCountdown, resetCounter]);\n  const countdownCallback = useCallback(() => {\n    if (count === countStop) {\n      stopCountdown();\n      return;\n    }\n    if (isIncrement) {\n      increment();\n    } else {\n      decrement();\n    }\n  }, [count, countStop, decrement, increment, isIncrement, stopCountdown]);\n  useInterval(countdownCallback, isCountdownRunning ? intervalMs : null);\n  return [count, { startCountdown, stopCountdown, resetCountdown }];\n}\nfunction useEventCallback(fn) {\n  const ref = useRef(() => {\n    throw new Error(\"Cannot call an event handler while rendering.\");\n  });\n  useIsomorphicLayoutEffect(() => {\n    ref.current = fn;\n  }, [fn]);\n  return useCallback((...args) => {\n    var _a;\n    return (_a = ref.current) == null ? void 0 : _a.call(ref, ...args);\n  }, [ref]);\n}\n\n// src/useLocalStorage/useLocalStorage.ts\nvar IS_SERVER = typeof window === \"undefined\";\nfunction useLocalStorage(key, initialValue, options = {}) {\n  const { initializeWithValue = true } = options;\n  const serializer = useCallback(\n    (value) => {\n      if (options.serializer) {\n        return options.serializer(value);\n      }\n      return JSON.stringify(value);\n    },\n    [options]\n  );\n  const deserializer = useCallback(\n    (value) => {\n      if (options.deserializer) {\n        return options.deserializer(value);\n      }\n      if (value === \"undefined\") {\n        return void 0;\n      }\n      const defaultValue = initialValue instanceof Function ? initialValue() : initialValue;\n      let parsed;\n      try {\n        parsed = JSON.parse(value);\n      } catch (error) {\n        console.error(\"Error parsing JSON:\", error);\n        return defaultValue;\n      }\n      return parsed;\n    },\n    [options, initialValue]\n  );\n  const readValue = useCallback(() => {\n    const initialValueToUse = initialValue instanceof Function ? initialValue() : initialValue;\n    if (IS_SERVER) {\n      return initialValueToUse;\n    }\n    try {\n      const raw = window.localStorage.getItem(key);\n      return raw ? deserializer(raw) : initialValueToUse;\n    } catch (error) {\n      console.warn(`Error reading localStorage key \\u201C${key}\\u201D:`, error);\n      return initialValueToUse;\n    }\n  }, [initialValue, key, deserializer]);\n  const [storedValue, setStoredValue] = useState(() => {\n    if (initializeWithValue) {\n      return readValue();\n    }\n    return initialValue instanceof Function ? initialValue() : initialValue;\n  });\n  const setValue = useEventCallback((value) => {\n    if (IS_SERVER) {\n      console.warn(\n        `Tried setting localStorage key \\u201C${key}\\u201D even though environment is not a client`\n      );\n    }\n    try {\n      const newValue = value instanceof Function ? value(readValue()) : value;\n      window.localStorage.setItem(key, serializer(newValue));\n      setStoredValue(newValue);\n      window.dispatchEvent(new StorageEvent(\"local-storage\", { key }));\n    } catch (error) {\n      console.warn(`Error setting localStorage key \\u201C${key}\\u201D:`, error);\n    }\n  });\n  const removeValue = useEventCallback(() => {\n    if (IS_SERVER) {\n      console.warn(\n        `Tried removing localStorage key \\u201C${key}\\u201D even though environment is not a client`\n      );\n    }\n    const defaultValue = initialValue instanceof Function ? initialValue() : initialValue;\n    window.localStorage.removeItem(key);\n    setStoredValue(defaultValue);\n    window.dispatchEvent(new StorageEvent(\"local-storage\", { key }));\n  });\n  useEffect(() => {\n    setStoredValue(readValue());\n  }, [key]);\n  const handleStorageChange = useCallback(\n    (event) => {\n      if (event.key && event.key !== key) {\n        return;\n      }\n      setStoredValue(readValue());\n    },\n    [key, readValue]\n  );\n  useEventListener(\"storage\", handleStorageChange);\n  useEventListener(\"local-storage\", handleStorageChange);\n  return [storedValue, setValue, removeValue];\n}\nvar IS_SERVER2 = typeof window === \"undefined\";\nfunction useMediaQuery(query, {\n  defaultValue = false,\n  initializeWithValue = true\n} = {}) {\n  const getMatches = (query2) => {\n    if (IS_SERVER2) {\n      return defaultValue;\n    }\n    return window.matchMedia(query2).matches;\n  };\n  const [matches, setMatches] = useState(() => {\n    if (initializeWithValue) {\n      return getMatches(query);\n    }\n    return defaultValue;\n  });\n  function handleChange() {\n    setMatches(getMatches(query));\n  }\n  useIsomorphicLayoutEffect(() => {\n    const matchMedia = window.matchMedia(query);\n    handleChange();\n    if (matchMedia.addListener) {\n      matchMedia.addListener(handleChange);\n    } else {\n      matchMedia.addEventListener(\"change\", handleChange);\n    }\n    return () => {\n      if (matchMedia.removeListener) {\n        matchMedia.removeListener(handleChange);\n      } else {\n        matchMedia.removeEventListener(\"change\", handleChange);\n      }\n    };\n  }, [query]);\n  return matches;\n}\n\n// src/useDarkMode/useDarkMode.ts\nvar COLOR_SCHEME_QUERY = \"(prefers-color-scheme: dark)\";\nvar LOCAL_STORAGE_KEY = \"usehooks-ts-dark-mode\";\nfunction useDarkMode(options = {}) {\n  const {\n    defaultValue,\n    localStorageKey = LOCAL_STORAGE_KEY,\n    initializeWithValue = true\n  } = options;\n  const isDarkOS = useMediaQuery(COLOR_SCHEME_QUERY, {\n    initializeWithValue,\n    defaultValue\n  });\n  const [isDarkMode, setDarkMode] = useLocalStorage(\n    localStorageKey,\n    defaultValue ?? isDarkOS ?? false,\n    { initializeWithValue }\n  );\n  useIsomorphicLayoutEffect(() => {\n    if (isDarkOS !== isDarkMode) {\n      setDarkMode(isDarkOS);\n    }\n  }, [isDarkOS]);\n  return {\n    isDarkMode,\n    toggle: () => {\n      setDarkMode((prev) => !prev);\n    },\n    enable: () => {\n      setDarkMode(true);\n    },\n    disable: () => {\n      setDarkMode(false);\n    },\n    set: (value) => {\n      setDarkMode(value);\n    }\n  };\n}\nfunction useUnmount(func) {\n  const funcRef = useRef(func);\n  funcRef.current = func;\n  useEffect(\n    () => () => {\n      funcRef.current();\n    },\n    []\n  );\n}\n\n// src/useDebounceCallback/useDebounceCallback.ts\nfunction useDebounceCallback(func, delay = 500, options) {\n  const debouncedFunc = useRef();\n  useUnmount(() => {\n    if (debouncedFunc.current) {\n      debouncedFunc.current.cancel();\n    }\n  });\n  const debounced = useMemo(() => {\n    const debouncedFuncInstance = debounce(func, delay, options);\n    const wrappedFunc = (...args) => {\n      return debouncedFuncInstance(...args);\n    };\n    wrappedFunc.cancel = () => {\n      debouncedFuncInstance.cancel();\n    };\n    wrappedFunc.isPending = () => {\n      return !!debouncedFunc.current;\n    };\n    wrappedFunc.flush = () => {\n      return debouncedFuncInstance.flush();\n    };\n    return wrappedFunc;\n  }, [func, delay, options]);\n  useEffect(() => {\n    debouncedFunc.current = debounce(func, delay, options);\n  }, [func, delay, options]);\n  return debounced;\n}\nfunction useDebounceValue(initialValue, delay, options) {\n  const eq = (options == null ? void 0 : options.equalityFn) ?? ((left, right) => left === right);\n  const unwrappedInitialValue = initialValue instanceof Function ? initialValue() : initialValue;\n  const [debouncedValue, setDebouncedValue] = useState(unwrappedInitialValue);\n  const previousValueRef = useRef(unwrappedInitialValue);\n  const updateDebouncedValue = useDebounceCallback(\n    setDebouncedValue,\n    delay,\n    options\n  );\n  if (!eq(previousValueRef.current, unwrappedInitialValue)) {\n    updateDebouncedValue(unwrappedInitialValue);\n    previousValueRef.current = unwrappedInitialValue;\n  }\n  return [debouncedValue, updateDebouncedValue];\n}\nfunction useDocumentTitle(title, options = {}) {\n  const { preserveTitleOnUnmount = true } = options;\n  const defaultTitle = useRef(null);\n  useIsomorphicLayoutEffect(() => {\n    defaultTitle.current = window.document.title;\n  }, []);\n  useIsomorphicLayoutEffect(() => {\n    window.document.title = title;\n  }, [title]);\n  useUnmount(() => {\n    if (!preserveTitleOnUnmount && defaultTitle.current) {\n      window.document.title = defaultTitle.current;\n    }\n  });\n}\nfunction useHover(elementRef) {\n  const [value, setValue] = useState(false);\n  const handleMouseEnter = () => {\n    setValue(true);\n  };\n  const handleMouseLeave = () => {\n    setValue(false);\n  };\n  useEventListener(\"mouseenter\", handleMouseEnter, elementRef);\n  useEventListener(\"mouseleave\", handleMouseLeave, elementRef);\n  return value;\n}\nfunction useIntersectionObserver({\n  threshold = 0,\n  root = null,\n  rootMargin = \"0%\",\n  freezeOnceVisible = false,\n  initialIsIntersecting = false,\n  onChange\n} = {}) {\n  var _a;\n  const [ref, setRef] = useState(null);\n  const [state, setState] = useState(() => ({\n    isIntersecting: initialIsIntersecting,\n    entry: void 0\n  }));\n  const callbackRef = useRef();\n  callbackRef.current = onChange;\n  const frozen = ((_a = state.entry) == null ? void 0 : _a.isIntersecting) && freezeOnceVisible;\n  useEffect(() => {\n    if (!ref)\n      return;\n    if (!(\"IntersectionObserver\" in window))\n      return;\n    if (frozen)\n      return;\n    let unobserve;\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const thresholds = Array.isArray(observer.thresholds) ? observer.thresholds : [observer.thresholds];\n        entries.forEach((entry) => {\n          const isIntersecting = entry.isIntersecting && thresholds.some((threshold2) => entry.intersectionRatio >= threshold2);\n          setState({ isIntersecting, entry });\n          if (callbackRef.current) {\n            callbackRef.current(isIntersecting, entry);\n          }\n          if (isIntersecting && freezeOnceVisible && unobserve) {\n            unobserve();\n            unobserve = void 0;\n          }\n        });\n      },\n      { threshold, root, rootMargin }\n    );\n    observer.observe(ref);\n    return () => {\n      observer.disconnect();\n    };\n  }, [\n    ref,\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    JSON.stringify(threshold),\n    root,\n    rootMargin,\n    frozen,\n    freezeOnceVisible\n  ]);\n  const prevRef = useRef(null);\n  useEffect(() => {\n    var _a2;\n    if (!ref && ((_a2 = state.entry) == null ? void 0 : _a2.target) && !freezeOnceVisible && !frozen && prevRef.current !== state.entry.target) {\n      prevRef.current = state.entry.target;\n      setState({ isIntersecting: initialIsIntersecting, entry: void 0 });\n    }\n  }, [ref, state.entry, freezeOnceVisible, frozen, initialIsIntersecting]);\n  const result = [\n    setRef,\n    !!state.isIntersecting,\n    state.entry\n  ];\n  result.ref = result[0];\n  result.isIntersecting = result[1];\n  result.entry = result[2];\n  return result;\n}\nfunction useIsClient() {\n  const [isClient, setClient] = useState(false);\n  useEffect(() => {\n    setClient(true);\n  }, []);\n  return isClient;\n}\nfunction useIsMounted() {\n  const isMounted = useRef(false);\n  useEffect(() => {\n    isMounted.current = true;\n    return () => {\n      isMounted.current = false;\n    };\n  }, []);\n  return useCallback(() => isMounted.current, []);\n}\nfunction useMap(initialState = /* @__PURE__ */ new Map()) {\n  const [map, setMap] = useState(new Map(initialState));\n  const actions = {\n    set: useCallback((key, value) => {\n      setMap((prev) => {\n        const copy = new Map(prev);\n        copy.set(key, value);\n        return copy;\n      });\n    }, []),\n    setAll: useCallback((entries) => {\n      setMap(() => new Map(entries));\n    }, []),\n    remove: useCallback((key) => {\n      setMap((prev) => {\n        const copy = new Map(prev);\n        copy.delete(key);\n        return copy;\n      });\n    }, []),\n    reset: useCallback(() => {\n      setMap(() => /* @__PURE__ */ new Map());\n    }, [])\n  };\n  return [map, actions];\n}\n\n// src/useOnClickOutside/useOnClickOutside.ts\nfunction useOnClickOutside(ref, handler, eventType = \"mousedown\", eventListenerOptions = {}) {\n  useEventListener(\n    eventType,\n    (event) => {\n      const target = event.target;\n      if (!target || !target.isConnected) {\n        return;\n      }\n      const isOutside = Array.isArray(ref) ? ref.filter((r) => Boolean(r.current)).every((r) => r.current && !r.current.contains(target)) : ref.current && !ref.current.contains(target);\n      if (isOutside) {\n        handler(event);\n      }\n    },\n    void 0,\n    eventListenerOptions\n  );\n}\nvar IS_SERVER3 = typeof window === \"undefined\";\nfunction useReadLocalStorage(key, options = {}) {\n  let { initializeWithValue = true } = options;\n  if (IS_SERVER3) {\n    initializeWithValue = false;\n  }\n  const deserializer = useCallback(\n    (value) => {\n      if (options.deserializer) {\n        return options.deserializer(value);\n      }\n      if (value === \"undefined\") {\n        return void 0;\n      }\n      let parsed;\n      try {\n        parsed = JSON.parse(value);\n      } catch (error) {\n        console.error(\"Error parsing JSON:\", error);\n        return null;\n      }\n      return parsed;\n    },\n    [options]\n  );\n  const readValue = useCallback(() => {\n    if (IS_SERVER3) {\n      return null;\n    }\n    try {\n      const raw = window.localStorage.getItem(key);\n      return raw ? deserializer(raw) : null;\n    } catch (error) {\n      console.warn(`Error reading localStorage key \\u201C${key}\\u201D:`, error);\n      return null;\n    }\n  }, [key, deserializer]);\n  const [storedValue, setStoredValue] = useState(() => {\n    if (initializeWithValue) {\n      return readValue();\n    }\n    return void 0;\n  });\n  useEffect(() => {\n    setStoredValue(readValue());\n  }, [key]);\n  const handleStorageChange = useCallback(\n    (event) => {\n      if (event.key && event.key !== key) {\n        return;\n      }\n      setStoredValue(readValue());\n    },\n    [key, readValue]\n  );\n  useEventListener(\"storage\", handleStorageChange);\n  useEventListener(\"local-storage\", handleStorageChange);\n  return storedValue;\n}\nvar initialSize = {\n  width: void 0,\n  height: void 0\n};\nfunction useResizeObserver(options) {\n  const { ref, box = \"content-box\" } = options;\n  const [{ width, height }, setSize] = useState(initialSize);\n  const isMounted = useIsMounted();\n  const previousSize = useRef({ ...initialSize });\n  const onResize = useRef(void 0);\n  onResize.current = options.onResize;\n  useEffect(() => {\n    if (!ref.current)\n      return;\n    if (typeof window === \"undefined\" || !(\"ResizeObserver\" in window))\n      return;\n    const observer = new ResizeObserver(([entry]) => {\n      const boxProp = box === \"border-box\" ? \"borderBoxSize\" : box === \"device-pixel-content-box\" ? \"devicePixelContentBoxSize\" : \"contentBoxSize\";\n      const newWidth = extractSize(entry, boxProp, \"inlineSize\");\n      const newHeight = extractSize(entry, boxProp, \"blockSize\");\n      const hasChanged = previousSize.current.width !== newWidth || previousSize.current.height !== newHeight;\n      if (hasChanged) {\n        const newSize = { width: newWidth, height: newHeight };\n        previousSize.current.width = newWidth;\n        previousSize.current.height = newHeight;\n        if (onResize.current) {\n          onResize.current(newSize);\n        } else {\n          if (isMounted()) {\n            setSize(newSize);\n          }\n        }\n      }\n    });\n    observer.observe(ref.current, { box });\n    return () => {\n      observer.disconnect();\n    };\n  }, [box, ref, isMounted]);\n  return { width, height };\n}\nfunction extractSize(entry, box, sizeType) {\n  if (!entry[box]) {\n    if (box === \"contentBoxSize\") {\n      return entry.contentRect[sizeType === \"inlineSize\" ? \"width\" : \"height\"];\n    }\n    return void 0;\n  }\n  return Array.isArray(entry[box]) ? entry[box][0][sizeType] : (\n    // @ts-ignore Support Firefox's non-standard behavior\n    entry[box][sizeType]\n  );\n}\nvar IS_SERVER4 = typeof window === \"undefined\";\nfunction useScreen(options = {}) {\n  let { initializeWithValue = true } = options;\n  if (IS_SERVER4) {\n    initializeWithValue = false;\n  }\n  const readScreen = () => {\n    if (IS_SERVER4) {\n      return void 0;\n    }\n    return window.screen;\n  };\n  const [screen, setScreen] = useState(() => {\n    if (initializeWithValue) {\n      return readScreen();\n    }\n    return void 0;\n  });\n  const debouncedSetScreen = useDebounceCallback(\n    setScreen,\n    options.debounceDelay\n  );\n  function handleSize() {\n    const newScreen = readScreen();\n    const setSize = options.debounceDelay ? debouncedSetScreen : setScreen;\n    if (newScreen) {\n      const {\n        width,\n        height,\n        availHeight,\n        availWidth,\n        colorDepth,\n        orientation,\n        pixelDepth\n      } = newScreen;\n      setSize({\n        width,\n        height,\n        availHeight,\n        availWidth,\n        colorDepth,\n        orientation,\n        pixelDepth\n      });\n    }\n  }\n  useEventListener(\"resize\", handleSize);\n  useIsomorphicLayoutEffect(() => {\n    handleSize();\n  }, []);\n  return screen;\n}\nvar cachedScriptStatuses = /* @__PURE__ */ new Map();\nfunction getScriptNode(src) {\n  const node = document.querySelector(\n    `script[src=\"${src}\"]`\n  );\n  const status = node == null ? void 0 : node.getAttribute(\"data-status\");\n  return {\n    node,\n    status\n  };\n}\nfunction useScript(src, options) {\n  const [status, setStatus] = useState(() => {\n    if (!src || (options == null ? void 0 : options.shouldPreventLoad)) {\n      return \"idle\";\n    }\n    if (typeof window === \"undefined\") {\n      return \"loading\";\n    }\n    return cachedScriptStatuses.get(src) ?? \"loading\";\n  });\n  useEffect(() => {\n    if (!src || (options == null ? void 0 : options.shouldPreventLoad)) {\n      return;\n    }\n    const cachedScriptStatus = cachedScriptStatuses.get(src);\n    if (cachedScriptStatus === \"ready\" || cachedScriptStatus === \"error\") {\n      setStatus(cachedScriptStatus);\n      return;\n    }\n    const script = getScriptNode(src);\n    let scriptNode = script.node;\n    if (!scriptNode) {\n      scriptNode = document.createElement(\"script\");\n      scriptNode.src = src;\n      scriptNode.async = true;\n      if (options == null ? void 0 : options.id) {\n        scriptNode.id = options.id;\n      }\n      scriptNode.setAttribute(\"data-status\", \"loading\");\n      document.body.appendChild(scriptNode);\n      const setAttributeFromEvent = (event) => {\n        const scriptStatus = event.type === \"load\" ? \"ready\" : \"error\";\n        scriptNode == null ? void 0 : scriptNode.setAttribute(\"data-status\", scriptStatus);\n      };\n      scriptNode.addEventListener(\"load\", setAttributeFromEvent);\n      scriptNode.addEventListener(\"error\", setAttributeFromEvent);\n    } else {\n      setStatus(script.status ?? cachedScriptStatus ?? \"loading\");\n    }\n    const setStateFromEvent = (event) => {\n      const newStatus = event.type === \"load\" ? \"ready\" : \"error\";\n      setStatus(newStatus);\n      cachedScriptStatuses.set(src, newStatus);\n    };\n    scriptNode.addEventListener(\"load\", setStateFromEvent);\n    scriptNode.addEventListener(\"error\", setStateFromEvent);\n    return () => {\n      if (scriptNode) {\n        scriptNode.removeEventListener(\"load\", setStateFromEvent);\n        scriptNode.removeEventListener(\"error\", setStateFromEvent);\n      }\n      if (scriptNode && (options == null ? void 0 : options.removeOnUnmount)) {\n        scriptNode.remove();\n        cachedScriptStatuses.delete(src);\n      }\n    };\n  }, [src, options == null ? void 0 : options.shouldPreventLoad, options == null ? void 0 : options.removeOnUnmount, options == null ? void 0 : options.id]);\n  return status;\n}\nvar IS_SERVER5 = typeof window === \"undefined\";\nfunction useScrollLock(options = {}) {\n  const { autoLock = true, lockTarget, widthReflow = true } = options;\n  const [isLocked, setIsLocked] = useState(false);\n  const target = useRef(null);\n  const originalStyle = useRef(null);\n  const lock = () => {\n    if (target.current) {\n      const { overflow, paddingRight } = target.current.style;\n      originalStyle.current = { overflow, paddingRight };\n      if (widthReflow) {\n        const offsetWidth = target.current === document.body ? window.innerWidth : target.current.offsetWidth;\n        const currentPaddingRight = parseInt(window.getComputedStyle(target.current).paddingRight, 10) || 0;\n        const scrollbarWidth = offsetWidth - target.current.scrollWidth;\n        target.current.style.paddingRight = `${scrollbarWidth + currentPaddingRight}px`;\n      }\n      target.current.style.overflow = \"hidden\";\n      setIsLocked(true);\n    }\n  };\n  const unlock = () => {\n    if (target.current && originalStyle.current) {\n      target.current.style.overflow = originalStyle.current.overflow;\n      if (widthReflow) {\n        target.current.style.paddingRight = originalStyle.current.paddingRight;\n      }\n    }\n    setIsLocked(false);\n  };\n  useIsomorphicLayoutEffect(() => {\n    if (IS_SERVER5)\n      return;\n    if (lockTarget) {\n      target.current = typeof lockTarget === \"string\" ? document.querySelector(lockTarget) : lockTarget;\n    }\n    if (!target.current) {\n      target.current = document.body;\n    }\n    if (autoLock) {\n      lock();\n    }\n    return () => {\n      unlock();\n    };\n  }, [autoLock, lockTarget, widthReflow]);\n  return { isLocked, lock, unlock };\n}\nvar IS_SERVER6 = typeof window === \"undefined\";\nfunction useSessionStorage(key, initialValue, options = {}) {\n  const { initializeWithValue = true } = options;\n  const serializer = useCallback(\n    (value) => {\n      if (options.serializer) {\n        return options.serializer(value);\n      }\n      return JSON.stringify(value);\n    },\n    [options]\n  );\n  const deserializer = useCallback(\n    (value) => {\n      if (options.deserializer) {\n        return options.deserializer(value);\n      }\n      if (value === \"undefined\") {\n        return void 0;\n      }\n      const defaultValue = initialValue instanceof Function ? initialValue() : initialValue;\n      let parsed;\n      try {\n        parsed = JSON.parse(value);\n      } catch (error) {\n        console.error(\"Error parsing JSON:\", error);\n        return defaultValue;\n      }\n      return parsed;\n    },\n    [options, initialValue]\n  );\n  const readValue = useCallback(() => {\n    const initialValueToUse = initialValue instanceof Function ? initialValue() : initialValue;\n    if (IS_SERVER6) {\n      return initialValueToUse;\n    }\n    try {\n      const raw = window.sessionStorage.getItem(key);\n      return raw ? deserializer(raw) : initialValueToUse;\n    } catch (error) {\n      console.warn(`Error reading sessionStorage key \\u201C${key}\\u201D:`, error);\n      return initialValueToUse;\n    }\n  }, [initialValue, key, deserializer]);\n  const [storedValue, setStoredValue] = useState(() => {\n    if (initializeWithValue) {\n      return readValue();\n    }\n    return initialValue instanceof Function ? initialValue() : initialValue;\n  });\n  const setValue = useEventCallback((value) => {\n    if (IS_SERVER6) {\n      console.warn(\n        `Tried setting sessionStorage key \\u201C${key}\\u201D even though environment is not a client`\n      );\n    }\n    try {\n      const newValue = value instanceof Function ? value(readValue()) : value;\n      window.sessionStorage.setItem(key, serializer(newValue));\n      setStoredValue(newValue);\n      window.dispatchEvent(new StorageEvent(\"session-storage\", { key }));\n    } catch (error) {\n      console.warn(`Error setting sessionStorage key \\u201C${key}\\u201D:`, error);\n    }\n  });\n  const removeValue = useEventCallback(() => {\n    if (IS_SERVER6) {\n      console.warn(\n        `Tried removing sessionStorage key \\u201C${key}\\u201D even though environment is not a client`\n      );\n    }\n    const defaultValue = initialValue instanceof Function ? initialValue() : initialValue;\n    window.sessionStorage.removeItem(key);\n    setStoredValue(defaultValue);\n    window.dispatchEvent(new StorageEvent(\"session-storage\", { key }));\n  });\n  useEffect(() => {\n    setStoredValue(readValue());\n  }, [key]);\n  const handleStorageChange = useCallback(\n    (event) => {\n      if (event.key && event.key !== key) {\n        return;\n      }\n      setStoredValue(readValue());\n    },\n    [key, readValue]\n  );\n  useEventListener(\"storage\", handleStorageChange);\n  useEventListener(\"session-storage\", handleStorageChange);\n  return [storedValue, setValue, removeValue];\n}\nfunction useStep(maxStep) {\n  const [currentStep, setCurrentStep] = useState(1);\n  const canGoToNextStep = currentStep + 1 <= maxStep;\n  const canGoToPrevStep = currentStep - 1 > 0;\n  const setStep = useCallback(\n    (step) => {\n      const newStep = step instanceof Function ? step(currentStep) : step;\n      if (newStep >= 1 && newStep <= maxStep) {\n        setCurrentStep(newStep);\n        return;\n      }\n      throw new Error(\"Step not valid\");\n    },\n    [maxStep, currentStep]\n  );\n  const goToNextStep = useCallback(() => {\n    if (canGoToNextStep) {\n      setCurrentStep((step) => step + 1);\n    }\n  }, [canGoToNextStep]);\n  const goToPrevStep = useCallback(() => {\n    if (canGoToPrevStep) {\n      setCurrentStep((step) => step - 1);\n    }\n  }, [canGoToPrevStep]);\n  const reset = useCallback(() => {\n    setCurrentStep(1);\n  }, []);\n  return [\n    currentStep,\n    {\n      goToNextStep,\n      goToPrevStep,\n      canGoToNextStep,\n      canGoToPrevStep,\n      setStep,\n      reset\n    }\n  ];\n}\n\n// src/useTernaryDarkMode/useTernaryDarkMode.ts\nvar COLOR_SCHEME_QUERY2 = \"(prefers-color-scheme: dark)\";\nvar LOCAL_STORAGE_KEY2 = \"usehooks-ts-ternary-dark-mode\";\nfunction useTernaryDarkMode({\n  defaultValue = \"system\",\n  localStorageKey = LOCAL_STORAGE_KEY2,\n  initializeWithValue = true\n} = {}) {\n  const isDarkOS = useMediaQuery(COLOR_SCHEME_QUERY2, { initializeWithValue });\n  const [mode, setMode] = useLocalStorage(localStorageKey, defaultValue, {\n    initializeWithValue\n  });\n  const isDarkMode = mode === \"dark\" || mode === \"system\" && isDarkOS;\n  const toggleTernaryDarkMode = () => {\n    const modes = [\"light\", \"system\", \"dark\"];\n    setMode((prevMode) => {\n      const nextIndex = (modes.indexOf(prevMode) + 1) % modes.length;\n      return modes[nextIndex];\n    });\n  };\n  return {\n    isDarkMode,\n    ternaryDarkMode: mode,\n    setTernaryDarkMode: setMode,\n    toggleTernaryDarkMode\n  };\n}\nfunction useTimeout(callback, delay) {\n  const savedCallback = useRef(callback);\n  useIsomorphicLayoutEffect(() => {\n    savedCallback.current = callback;\n  }, [callback]);\n  useEffect(() => {\n    if (!delay && delay !== 0) {\n      return;\n    }\n    const id = setTimeout(() => {\n      savedCallback.current();\n    }, delay);\n    return () => {\n      clearTimeout(id);\n    };\n  }, [delay]);\n}\nfunction useToggle(defaultValue) {\n  const [value, setValue] = useState(!!defaultValue);\n  const toggle = useCallback(() => {\n    setValue((x) => !x);\n  }, []);\n  return [value, toggle, setValue];\n}\nvar IS_SERVER7 = typeof window === \"undefined\";\nfunction useWindowSize(options = {}) {\n  let { initializeWithValue = true } = options;\n  if (IS_SERVER7) {\n    initializeWithValue = false;\n  }\n  const [windowSize, setWindowSize] = useState(() => {\n    if (initializeWithValue) {\n      return {\n        width: window.innerWidth,\n        height: window.innerHeight\n      };\n    }\n    return {\n      width: void 0,\n      height: void 0\n    };\n  });\n  const debouncedSetWindowSize = useDebounceCallback(\n    setWindowSize,\n    options.debounceDelay\n  );\n  function handleSize() {\n    const setSize = options.debounceDelay ? debouncedSetWindowSize : setWindowSize;\n    setSize({\n      width: window.innerWidth,\n      height: window.innerHeight\n    });\n  }\n  useEventListener(\"resize\", handleSize);\n  useIsomorphicLayoutEffect(() => {\n    handleSize();\n  }, []);\n  return windowSize;\n}\n\nexport { useBoolean, useClickAnyWhere, useCopyToClipboard, useCountdown, useCounter, useDarkMode, useDebounceCallback, useDebounceValue, useDocumentTitle, useEventCallback, useEventListener, useHover, useIntersectionObserver, useInterval, useIsClient, useIsMounted, useIsomorphicLayoutEffect, useLocalStorage, useMap, useMediaQuery, useOnClickOutside, useReadLocalStorage, useResizeObserver, useScreen, useScript, useScrollLock, useSessionStorage, useStep, useTernaryDarkMode, useTimeout, useToggle, useUnmount, useWindowSize };\n","export function px(value: number) {\r\n  return `${value}px`\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { px } from '../utils'\r\n\r\nconst Styles = styled.div`\r\n    position: absolute;\r\n    background: rgba(110, 136, 255, 0.8);\r\n    border: 1px solid rgb(192 206 212 / 60%);\r\n`\r\n\r\nexport function MiniNode(props: { left: number, top: number, width: number, height: number }) {\r\n  return <Styles style={{\r\n    left: px(props.left),\r\n    top: px(props.top),\r\n    width: px(props.width),\r\n    height: px(props.height)\r\n  }} data-testid=\"minimap-node\"/>\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { useDrag } from '../../../shared/drag'\r\nimport { Rect, Transform, Translate } from '../types'\r\nimport { px } from '../utils'\r\n\r\nconst MiniViewportStyles = styled.div`\r\n  position: absolute;\r\n  background: rgba(255, 251, 128, 0.32);\r\n  border: 1px solid #ffe52b;\r\n`\r\n\r\nexport function MiniViewport(props: Rect & { containerWidth: number, start(): Transform, translate: Translate }) {\r\n  const scale = (v: number) => v * props.containerWidth\r\n  const invert = (v: number) => v / props.containerWidth\r\n  const drag = useDrag((dx, dy) => {\r\n    props.translate(invert(-dx), invert(-dy))\r\n  }, e => ({ x: e.pageX, y: e.pageY }))\r\n\r\n  return <MiniViewportStyles\r\n    onPointerDown={drag.start}\r\n    style={{\r\n      left: px(scale(props.left)),\r\n      top: px(scale(props.top)),\r\n      width: px(scale(props.width)),\r\n      height: px(scale(props.height))\r\n    }}\r\n    data-testid=\"minimap-viewport\"\r\n  />\r\n}\r\n","import * as React from 'react'\r\nimport { useCallback, useRef } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useResizeObserver } from 'usehooks-ts'\r\n\r\nimport { Rect, Transform, Translate } from '../types'\r\nimport { px } from '../utils'\r\nimport { MiniNode } from './MiniNode'\r\nimport { MiniViewport } from './MiniViewport'\r\n\r\nconst Styles = styled.div<{ size: number }>`\r\n    position: absolute;\r\n    right: 24px;\r\n    bottom: 24px;\r\n    background: rgba(229, 234, 239, 0.65);\r\n    padding: 20px;\r\n    overflow: hidden;\r\n    border: 1px solid #b1b7ff;\r\n    border-radius: 8px;\r\n    box-sizing: border-box;\r\n`\r\n\r\ntype Props = {\r\n  size: number\r\n  ratio: number\r\n  nodes: Rect[]\r\n  viewport: Rect\r\n  start(): Transform\r\n  translate: Translate\r\n  point(x: number, y: number): void\r\n}\r\n\r\nexport function Minimap(props: Props) {\r\n  const ref = useRef<HTMLDivElement>(null)\r\n  const { width = 0 } = useResizeObserver({\r\n    // https://github.com/juliencrn/usehooks-ts/issues/663\r\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\r\n    // @ts-expect-error\r\n    ref: ref\r\n  })\r\n  const containerWidth = ref.current?.clientWidth || width\r\n  const scale = useCallback((v: number) => v * containerWidth, [containerWidth])\r\n\r\n  return <Styles\r\n    size={props.size}\r\n    style={{\r\n      width: px(props.size * props.ratio),\r\n      height: px(props.size)\r\n    }}\r\n    onPointerDown={(e: React.PointerEvent) => {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n    }}\r\n    onDoubleClick={(e: React.MouseEvent) => {\r\n      e.stopPropagation()\r\n      e.preventDefault()\r\n      if (!ref.current) return\r\n      const box = ref.current.getBoundingClientRect()\r\n      const x = (e.clientX - box.left) / (props.size * props.ratio)\r\n      const y = (e.clientY - box.top) / (props.size * props.ratio)\r\n\r\n      props.point(x, y)\r\n    }}\r\n    ref={ref}\r\n    data-testid=\"minimap\"\r\n  >\r\n    {containerWidth\r\n      ? props.nodes.map((node, i) => <MiniNode\r\n        key={i}\r\n        left={scale(node.left)}\r\n        top={scale(node.top)}\r\n        width={scale(node.width)}\r\n        height={scale(node.height)}\r\n      />)\r\n      : null}\r\n    <MiniViewport\r\n      {...props.viewport}\r\n      start={props.start}\r\n      containerWidth={containerWidth}\r\n      translate={props.translate}\r\n    />\r\n  </Styles>\r\n}\r\n","import * as React from 'react'\r\nimport { BaseSchemes } from 'rete'\r\n\r\nimport { RenderPreset } from '../types'\r\nimport { Minimap } from './components/Minimap'\r\nimport { MinimapRender } from './types'\r\n\r\n/**\r\n * Preset for rendering minimap.\r\n */\r\nexport function setup<Schemes extends BaseSchemes, K extends MinimapRender>(props?: { size?: number }): RenderPreset<Schemes, K> {\r\n  return {\r\n    render(context) {\r\n      if (context.data.type === 'minimap') {\r\n        return <Minimap\r\n          nodes={context.data.nodes}\r\n          size={props?.size || 200}\r\n          ratio={context.data.ratio}\r\n          viewport={context.data.viewport}\r\n          start={context.data.start}\r\n          translate={context.data.translate}\r\n          point={context.data.point}\r\n        />\r\n      }\r\n    }\r\n  }\r\n}\r\n","import * as React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nimport { useDrag } from '../../shared/drag'\r\nimport { Position } from '../../types'\r\nimport { Pin as PinType } from './types'\r\n\r\nconst pinSize = 20\r\n\r\nconst Styles = styled.div<{ selected?: boolean }>`\r\n  width: ${pinSize}px;\r\n  height: ${pinSize}px;\r\n  box-sizing: border-box;\r\n  background: ${props => props.selected\r\n    ? '#ffd92c'\r\n    : 'steelblue'};\r\n  border: 2px solid white;\r\n  border-radius: ${pinSize}px;\r\n`\r\n\r\ntype Props = PinType & {\r\n  contextMenu(): void\r\n  translate(dx: number, dy: number): void\r\n  pointerdown(): void\r\n  pointer(): Position\r\n}\r\n\r\nexport function Pin(props: Props) {\r\n  const drag = useDrag((dx, dy) => {\r\n    props.translate(dx, dy)\r\n  }, props.pointer)\r\n  const { x, y } = props.position\r\n\r\n  return (\r\n    <Styles\r\n      onPointerDown={(e: React.PointerEvent) => {\r\n        e.stopPropagation()\r\n        e.preventDefault()\r\n        drag.start(e)\r\n        props.pointerdown()\r\n      }}\r\n      onContextMenu={(e: React.MouseEvent) => {\r\n        e.stopPropagation()\r\n        e.preventDefault()\r\n        props.contextMenu()\r\n      }}\r\n      selected={props.selected}\r\n      style={{ position: 'absolute', top: `${y - pinSize / 2}px`, left: `${x - pinSize / 2}px` }}\r\n      data-testid=\"pin\"\r\n    >\r\n\r\n    </Styles>\r\n  )\r\n}\r\n","\r\nimport * as React from 'react'\r\nimport { BaseSchemes } from 'rete'\r\nimport { BaseAreaPlugin } from 'rete-area-plugin'\r\n\r\nimport { Position } from '../../types'\r\nimport { RenderPreset } from '../types'\r\nimport { Pin } from './Pin'\r\nimport { PinData, PinsRender } from './types'\r\n\r\ntype Props = {\r\n  translate?: (id: string, dx: number, dy: number) => void\r\n  contextMenu?: (id: string) => void\r\n  pointerdown?: (id: string) => void\r\n}\r\n\r\n/**\r\n * Preset for rendering pins.\r\n */\r\nexport function setup<Schemes extends BaseSchemes, K extends PinsRender>(props?: Props): RenderPreset<Schemes, K> {\r\n  function renderPins(data: PinData, pointer: () => Position) {\r\n    return <>\r\n      {data.pins.map(pin => (\r\n        <Pin\r\n          {...pin}\r\n          key={pin.id}\r\n          contextMenu={() => {\r\n            props?.contextMenu?.(pin.id)\r\n          }}\r\n          translate={(dx, dy) => {\r\n            props?.translate?.(pin.id, dx, dy)\r\n          }}\r\n          pointerdown={() => {\r\n            props?.pointerdown?.(pin.id)\r\n          }}\r\n          pointer={pointer}\r\n        />\r\n      ))}\r\n    </>\r\n  }\r\n\r\n  return {\r\n    render(context, plugin) {\r\n      const data = context.data\r\n      const area = plugin.parentScope<BaseAreaPlugin<Schemes, PinsRender>>(BaseAreaPlugin)\r\n\r\n      if (data.type === 'reroute-pins') {\r\n        return renderPins(data.data, () => area.area.pointer)\r\n      }\r\n    }\r\n  }\r\n}\r\n","/**\r\n * Built-in presets, responsible for rendering different parts of the editor.\r\n * @module\r\n */\r\nexport * as classic from './classic'\r\nexport * as contextMenu from './context-menu'\r\nexport * as minimap from './minimap'\r\nexport * as reroute from './reroute-pins'\r\n","import * as React from 'react'\r\nimport { BaseSchemes, CanAssignSignal, Scope } from 'rete'\r\n\r\nimport { RenderPreset } from './presets/types'\r\nimport { CreateRoot, getRenderer, HasLegacyRender, Renderer } from './renderer'\r\nimport { Position, RenderSignal } from './types'\r\nimport { Root } from './utils'\r\n\r\nexport * as Presets from './presets'\r\nexport type { ClassicScheme, ReactArea2D, RenderEmit } from './presets/classic'\r\nexport { RefComponent } from './ref-component'\r\nexport * from './shared'\r\nexport * from './types'\r\nexport { useRete } from './utils'\r\n\r\n/**\r\n * Signals that can be emitted by the plugin\r\n * @priority 9\r\n */\r\nexport type Produces<Schemes extends BaseSchemes> =\r\n  | { type: 'connectionpath', data: { payload: Schemes['Connection'], path?: string, points: Position[] } }\r\n\r\ntype Requires<Schemes extends BaseSchemes> =\r\n  | RenderSignal<'node', { payload: Schemes['Node'] }>\r\n  | RenderSignal<'connection', { payload: Schemes['Connection'], start?: Position, end?: Position }>\r\n  | { type: 'unmount', data: { element: HTMLElement } }\r\n\r\n/**\r\n * Plugin props\r\n */\r\nexport type Props = HasLegacyRender extends true ? {\r\n  /** root factory for React.js 18+ */\r\n  createRoot?: CreateRoot\r\n} : {\r\n  createRoot: CreateRoot\r\n}\r\n\r\n/**\r\n * React plugin. Renders nodes, connections and other elements using React.\r\n * @priority 10\r\n * @emits connectionpath\r\n * @listens render\r\n * @listens unmount\r\n */\r\nexport class ReactPlugin<Schemes extends BaseSchemes, T = Requires<Schemes>> extends Scope<Produces<Schemes>, [Requires<Schemes> | T]> {\r\n  renderer: Renderer\r\n  presets: RenderPreset<Schemes, T>[] = []\r\n\r\n  constructor(...[props]: HasLegacyRender extends true ? [props?: Props] : [props: Props]) {\r\n    super('react-render')\r\n    this.renderer = getRenderer({ createRoot: props?.createRoot })\r\n\r\n    this.addPipe(context => {\r\n      if (!context || typeof context !== 'object' || !('type' in context)) return context\r\n      if (context.type === 'unmount') {\r\n        this.unmount(context.data.element)\r\n      } else if (context.type === 'render') {\r\n        if ('filled' in context.data && context.data.filled) {\r\n          return context\r\n        }\r\n        if (this.mount(context.data.element, context)) {\r\n          return {\r\n            ...context,\r\n            data: {\r\n              ...context.data,\r\n              filled: true\r\n            }\r\n          } as typeof context\r\n        }\r\n      }\r\n\r\n      return context\r\n    })\r\n  }\r\n\r\n  setParent(scope: Scope<Requires<Schemes> | T>): void {\r\n    super.setParent(scope)\r\n\r\n    this.presets.forEach(preset => {\r\n      if (preset.attach) preset.attach(this)\r\n    })\r\n  }\r\n\r\n  private mount(element: HTMLElement, context: Requires<Schemes>) {\r\n    const parent = this.parentScope()\r\n\r\n    for (const preset of this.presets) {\r\n      const result = preset.render(context as any, this)\r\n\r\n      if (!result) continue\r\n\r\n      const reactElement = (\r\n        <Root rendered={() => void parent.emit({ type: 'rendered', data: context.data } as T)}>\r\n          {result}\r\n        </Root>\r\n      )\r\n\r\n      this.renderer.mount(reactElement, element)\r\n      return true\r\n    }\r\n  }\r\n\r\n  private unmount(element: HTMLElement) {\r\n    this.renderer.unmount(element)\r\n  }\r\n\r\n  /**\r\n   * Adds a preset to the plugin.\r\n   * @param preset Preset that can render nodes, connections and other elements.\r\n   */\r\n  public addPreset<K>(preset: RenderPreset<Schemes, CanAssignSignal<T, K> extends true ? K : 'Cannot apply preset. Provided signals are not compatible'>) {\r\n    const local = preset as RenderPreset<Schemes, T>\r\n\r\n    if (local.attach) local.attach(this)\r\n    this.presets.push(local)\r\n  }\r\n}\r\n"],"names":["getRenderer","props","createRoot","wrappers","WeakMap","getWrapper","container","wrapper","get","span","document","createElement","appendChild","set","removeWrapper","remove","roots","mount","element","_wrapper$firstElement","root","render","firstElementChild","unmount","Error","Root","_ref","children","rendered","useEffect","syncFlush","ready","useRef","current","apply","f","queueMicrotask","flushSync","useRete","create","_useState","useState","_useState2","_slicedToArray","setContainer","editorRef","undefined","_useState3","_useState4","editor","setEditor","ref","destroy","innerHTML","then","value","ConnectionContext","createContext","start","end","path","ConnectionWrapper","computedStart","setStart","computedEnd","setEnd","_useState5","_useState6","setPath","flush","unwatch1","s","unwatch2","p","React","Provider","useConnection","useContext","Svg","styled","svg","_templateObject","_taggedTemplateLiteral","Path","_templateObject2","_props$styles","styles","call","Connection","_useConnection","d","copyEvent","e","newEvent","constructor","type","Object","getPrototypeOf","keys","getOwnPropertyNames","_iterator","_createForOfIteratorHelper","_step","n","done","k","item","defineProperty","err","rootPrefix","findReactRoot","_reactRootContainer","some","key","startsWith","parentElement","useDrag","translate","getPointer","previous","_objectSpread","move","moveEvent","dx","x","dy","y","up","window","removeEventListener","addEventListener","useNoDrag","disabled","handleClick","target","version","stopPropagation","dispatchEvent","el","NoDrag","Input","input","Control","_React$useState","data","_React$useState2","setValue","Drag","readOnly","readonly","onChange","val","$nodecolor","$nodecolorselected","$socketsize","$socketmargin","$socketcolor","$nodewidth","RefComponent","init","_objectWithoutProperties","_excluded","_extends","RefControl","name","emit","payload","className","RefSocket","nodeId","side","socketKey","NodeStyles","div","Number","isFinite","width","concat","height","selected","css","sortByIndex","entries","sort","a","b","_a$","_b$","ai","index","bi","Node","inputs","outputs","controls","_props$data","id","label","map","_ref2","output","socket","_ref3","_ref4","control","_ref5","_ref6","showControl","Styles","Hoverable","Socket","title","setup","positionWatcher","socketPositionWatcher","getDOMSocketPosition","customize","node","connection","attach","plugin","context","parent","parentScope","Component","sourceOutput","targetInput","source","change","listen","_asyncToGenerator","_regeneratorRuntime","mark","_callee","response","_response$data","points","curvature","wrap","_context","prev","next","sent","abrupt","length","isLoop","loopConnectionPath","classicConnectionPath","stop","_x","_x2","arguments","_Component","_Component2","ClassicPreset","InputControl","_Component3","useDebounce","cb","timeout","cancel","clearTimeout","func","setTimeout","$contextColor","$contextColorLight","$contextColorDark","$contextMenuRound","$width","CommonStyle","ItemStyle","hasSubitems","SubitemStyles","_templateObject3","ItemElement","_props$components","_props$components$ite","_props$components2","_props$components2$su","visibleSubitems","setVisibleSubitems","setInvisibile","useCallback","_useDebounce","delay","_useDebounce2","hide","cancelHide","components","Subitems","subitems","onClick","handler","Boolean","onPointerDown","onPointerOver","onPointerLeave","SearchInput","Search","component","onInput","Menu","_props$components$mai","_props$components2$co","_props$components3","_props$components3$se","onHide","filter","setFilter","filterRegexp","RegExp","filteredList","items","match","main","Common","common","onMouseOver","onMouseLeave","onWheel","searchBar","search","global","px","MiniNode","style","left","top","MiniViewportStyles","MiniViewport","scale","v","containerWidth","invert","drag","pageX","pageY","Minimap","_ref$current","_useResizeObserver","useResizeObserver","_useResizeObserver$wi","clientWidth","size","ratio","preventDefault","onDoubleClick","box","getBoundingClientRect","clientX","clientY","point","nodes","i","viewport","pinSize","Pin","pointer","_props$position","position","pointerdown","onContextMenu","contextMenu","renderPins","Fragment","pins","pin","_props$contextMenu","_props$translate","_props$pointerdown","area","BaseAreaPlugin","ReactPlugin","_Scope","_this","_len","Array","_key","_classCallCheck","_callSuper","_defineProperty","renderer","addPipe","_typeof","filled","_inherits","_createClass","setParent","scope","_this2","_superPropGet","presets","forEach","preset","result","reactElement","addPreset","local","push","Scope"],"mappings":"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"}